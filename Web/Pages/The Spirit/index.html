<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>The Spirit</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>

        <meta property="og:title" content="The Spirit" />
        <meta property="og:description" content="The Spirit is a personal experiment by Edan Kwan." />
        <meta property="og:image:type" content="image/jpeg" />
        <meta property="og:image:width" content="800" />
        <meta property="og:image:height" content="480" />
        <meta property="og:image" content="http://www.edankwan.com/experiments/the-spirit/images/share.jpg" />

        <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="@edankwan">
        <meta name="twitter:url" content="http://www.edankwan.com/experiments/the-spirit">
        <meta name="twitter:title" content="The Spirit">
        <meta name="twitter:description" content="The Spirit is a personal experiment by Edan Kwan.">
        
        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/index.css">
    </head>
    
    <body>
        <div class="mobile">
            <p>Sorry, this experiment is not designed for mobile devices. But if you think your device can handle it, you can keep forward to access the experiment <span class="mobile-bypass">here</span>.</p>
            <p>Or you check out the <a href="https://www.youtube.com/watch?v=lcHAtTGzQE8" target="_blank">video capture</a> of this experiment instead. The source code is also accessible at <a href="https://github.com/edankwan/The-Spirit" target="_blank">Github</a>.</p>
            <p>Sorry for any inconvenience caused.</p>
            <p>Cheers,</p>
            <p><a href="http://www.edankwan.com/" target="_blank">Edan Kwan</a></p>
        </div>
        <div class="logo"></div>
        <div class="instruction">Press space key to toggle movement</div>
        <div class="footer">
            <span><a href="http://www.edankwan.com/" target="_blank">Edan Kwan</a></span>
            <span>|</span>
            <span><a href="https://github.com/edankwan/The-Spirit" target="_blank">Github</a></span>
            <span>|</span>
            <span><a href="https://www.youtube.com/watch?v=lcHAtTGzQE8" target="_blank">Youtube</a></span>
        </div>
        <script src="js/three.r74.min.js"></script>
        <script src="js/index.js"></script>
    </body>

    <script type="text/javascript">

        function livelyPropertyListener(name, val)
        {
          switch(name) {
            case "followMouse":
              guiInterface("bool","follow mouse", val);
              break;
            case "orbit":
              guiInterface("bool","Orbit", val);
              break;
            case "newParticle":
              guiInterface("bool","new particle");
              break;
            case "speed":
              guiInterface("text","speed",val/10);
              break;
            case "dieSpeed":
              guiInterface("text","dieSpeed",val/1000);
              break;
            case "radius":
              guiInterface("text","radius",val/100);
              break;
            case "curlSize":
              guiInterface("text","curlSize",val/1000);
              break;
            case "attraction":
              guiInterface("text","attraction",val/100);
              break;
            case "shadow":
              guiInterface("text","shadow",val/100);
              break;
            case "baseColor":
              guiInterface("color","base Color",val);//in hex.
              break;    
            case "fadeColor":
              guiInterface("color","fade Color",val);
              break;
            case "bgColor":
              guiInterface("color","background Color",val);
              break;
            case "particleAmt":
              switch(val){
                case 0:
                  guiInterface("combo","amount","4k");
                  break;
                case 1:
                  guiInterface("combo","amount","8k");
                  break;
                case 2:
                  guiInterface("combo","amount","16k");
                  break;
                case 3:
                  guiInterface("combo","amount","32k");
                  break;
                case 4:
                  guiInterface("combo","amount","65k");
                  break;
                case 5:
                  guiInterface("combo","amount","131k");
                  break;
                case 6:
                  guiInterface("combo","amount","252k");
                  break; 
                case 7:
                  guiInterface("combo","amount","524k");
                  break;
                case 8:
                  guiInterface("combo","amount","1m");
                  break; 
                case 9:
                  guiInterface("combo","amount","2m");
                  break; 
                case 10:
                  guiInterface("combo","amount","3m");
                  break;
                case 11:
                  guiInterface("combo","amount","4m");
                  break;                    
              }
              break;
            case "fxaa":
              guiInterface("bool","fxaa", val);
              break;
            case "motionBlur":
              guiInterface("bool","motionBlur", val);
              break;
            case "bloom":
              guiInterface("bool","bloom", val);
              break;

          }
        }
        
      function guiInterface(type,target,val){
          const evt = document.createEvent("HTMLEvents");
          for(var el of document.querySelectorAll('.property-name')){
            if(el.innerText == target){
              if(type!=="combo")
              {
                const input = el.nextElementSibling.querySelector('input');
                if(type=="text"){
                  input.value=val;
                  evt.initEvent("change", false, true);
                  input.dispatchEvent(evt);    
                }
                else if(type=="bool"){
                  if(input.checked!=val){
                    evt.initEvent("change", false, true);
                    input.dispatchEvent(evt);    
                  }
                }
                else{
                  input.value=val;
                  evt.initEvent("blur", false, true);
                  input.dispatchEvent(evt);
                }
              }
              else if(type==="combo"){
                const input = el.nextElementSibling.querySelector('select');
                if(input.value!=val){
                  input.value=val;
                  evt.initEvent("change", false, true);
                  input.dispatchEvent(evt);
                }
              }
            }
          }
        }

    </script>

    <style>
        .dg.ac,.footer,.instruction{
             display: none!important; 
        }
    </style>
</html>
